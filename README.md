
<!-- README.md is generated from README.Rmd. Please edit that file -->

# sigstart

<!-- badges: start -->

[![Lifecycle:
experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![CRAN
status](https://www.r-pkg.org/badges/version/sigstart)](https://CRAN.R-project.org/package=sigstart)
[![R-CMD-check](https://github.com/selkamand/sigstart/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/selkamand/sigstart/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

**Sigstart** reads small variants, copy number changes, and structural
rearrangements from common bioinformatics file formats like VCFs and
segment files. It converts these data into formats compatible with
**sigminer** and other signature analysis tools.

## Installation

You can install the development version of sigstart from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("selkamand/sigstart")
```

## Quick Start

``` r
library(sigstart)

# Convert SNVs and Indels from a tumor-normal VCF -> MAF-like structure for sigminer
path_vcf_snv <- system.file("tumor_normal.purple.somatic.vcf.gz",package = "sigstart")
sigminer_maf_like_dataframe <- parse_vcf_to_sigminer_maf(path_vcf_snv, sample_id = "tumor_sample")
#> ℹ Found 2 samples described in the VCF [normal_sample and tumor_sample]
#> ℹ Returning data for only sample [tumor_sample] samples in format column of VCF.
```

``` r

# Convert Purple SVs from VCF -> BEDPE-like structure for sigminer
path_vcf_sv <- system.file("tumor_sample.purple.sv.vcf", package = "sigstart")
sigminer_sv_dataframe <-  parse_purple_sv_vcf_to_sigminer(path_vcf_sv, sample_id = "tumor_sample")

# Convert Purple SVs from VCF -> BEDPE structure for sigprofiler
bedpe_dataframe <- parse_purple_sv_vcf_to_sigprofiler(path_vcf_sv)

# Convert Purple SVs from VCF -> BEDPE structure (identical output to above)
bedpe_dataframe <- parse_purple_sv_vcf_to_bedpe(path_vcf_sv)

# Convert Purple CN Segment File -> Sigminer 
path_cn <- system.file("COLO829v003T.purple.cnv.somatic.tsv", package = "sigstart")
sigminer_cn_dataframe <- parse_purple_cnv_to_sigminer(path_cn, sample_id = "tumor_sample")

# Convert CN Segment Files from other tools -> Sigminer
# (by manually specifying the column name mappings)
path_cn_notpurple <- system.file("pcawg.single_sample.copynumber.notpurple.segment", package = "sigstart")
sigminer_cn_dataframe <- parse_cnv_to_sigminer(
  path_cn_notpurple,
  sample_id = "tumor_sample",
  col_chromosome = "chr",
  col_start = "start",
  col_end = "end",
  col_copynumber = "total_cn",
  col_minor_cn = "minor_cn"
)
```

## Cohort -\> Single Sample Files

Signature analysis tools including sigscreen and signal are easier to
run from single sample data files. Here we demonstrate how to create the

### Converting cohort MAF to single sample VCFs

Signature analysis tools including sigscreen and signal are easier to
run from single sample VCFs than cohort-MAFs. The convert_maf_to_vcfs
function splits a cohort MAF file into a collection of minimal single
sample vcfs.

``` r
library(sigstart)
path_maf <- system.file(package = "sigstart", "pcawg.3sample.snvs_indel.maf")
convert_maf_to_vcfs(path_maf, outdir = "single_sample_files/vcfs")
#> ℹ Found a total of 3 samples in the MAF file
#>   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%
#> 
#> ✔ Successfullly saved 3 samples to  `<sample>.snv_indel.vcf` files in 'single_sample_files/vcfs'
```

``` r

# Parse the vcfs (no need to specify a sample ID since these are single sample VCFS)
parse_vcf_to_sigminer_maf("single_sample_files/vcfs/DO1000.snv_indel.vcf.bgz")
#> ℹ Found 1 samples described in the VCF [DO1000]
```

### Converting cohort copynumber calls into single sample segment VCFs

``` r
path_copynumber <- system.file(package = "sigstart", "pcawg.3sample.copynumber.segment")
convert_cohort_segment_file_to_single_samples(path_copynumber, outdir = "single_sample_files/cnvs")
#> ℹ Found a total of 3 samples in the segment file '/private/var/folders/d9/x2yygv_13_15dw5f8fspdn880000gp/T/Rtmp85tMpO/temp_libpath46a6206ca762/sigstart/pcawg.3sample.copynumber.segment'
#>   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%
#> 
#> ✔ Successfullly saved 3 samples to  `<sample>.copynumber.tsv` files in 'single_sample_files/cnvs'
```

``` r

# Parse the copynumber file
parse_cnv_to_sigminer("single_sample_files/cnvs/DO1000.copynumber.tsv.bgz", sample_id = "D01000")
#>     sample Chromosome  Start.bp    End.bp modal_cn minor_cn
#> 1   D01000          1     10001    790502        3        1
#> 2   D01000          1    790503   5052500        3        1
#> 3   D01000          1   5052501   5219983        3        1
#> 4   D01000          1   5219984  74599976        3        1
#> 5   D01000          1  74599977 118369934        3        1
#> 6   D01000          1 118369935 118774913        3        1
#> 7   D01000          1 118774914 119965257        3        1
#> 8   D01000          1 119965258 121499999        3        1
#> 9   D01000          1 121500000 128899999       NA       NA
#> 10  D01000          1 128900000 142602938        3        1
#> 11  D01000          1 142602939 143969969        6        3
#> 12  D01000          1 143969970 247247500        5        2
#> 13  D01000          1 247247501 249159944        5        2
#> 14  D01000          2     55926  23419993        3        1
#> 15  D01000          2  23419994  87632401        3        1
#> 16  D01000          2  87632402  89842499        3        1
#> 17  D01000          2  89842500  96799999        3        1
#> 18  D01000          2  96800000 119236330        3        1
#> 19  D01000          2 119236331 137143201        3        1
#> 20  D01000          2 137143202 177149981        4        2
#> 21  D01000          2 177149982 242951000        3        1
#> 22  D01000          3     17957    100073        3        1
#> 23  D01000          3    100074    247486        4        1
#> 24  D01000          3    247487    276662        5        2
#> 25  D01000          3    276663    339962        6        2
#> 26  D01000          3    339963    918549        3        1
#> 27  D01000          3    918550   1030976        6        2
#> 28  D01000          3   1030977   1124366        3        1
#> 29  D01000          3   1124367   4150002        3        1
#> 30  D01000          3   4150003   8459979        4        2
#> 31  D01000          3   8459980  22349999        3        1
#> 32  D01000          3  22350000  87899999        3        1
#> 33  D01000          3  87900000  93899999        3        1
#> 34  D01000          3  93900000 124210061        3        1
#> 35  D01000          3 124210062 162075171        3        1
#> 36  D01000          3 162075172 176679927        3        1
#> 37  D01000          3 176679928 187630068        3        1
#> 38  D01000          3 187630069 192227800        3        1
#> 39  D01000          3 192227801 197800842        4        1
#> 40  D01000          4     27500  48199999        4        2
#> 41  D01000          4  48200000  52699999       NA       NA
#> 42  D01000          4  52700000 127513782        5        2
#> 43  D01000          4 127513783 127763836        5        2
#> 44  D01000          4 127763837 131789956        5        2
#> 45  D01000          4 131789957 132722464        4        2
#> 46  D01000          4 132722465 133030569        5        2
#> 47  D01000          4 133030570 133595279        4        2
#> 48  D01000          4 133595280 190005034        4        2
#> 49  D01000          4 190005035 190798560        2        1
#> 50  D01000          5     22500    851581        4        2
#> 51  D01000          5    851582   5077157        4        2
#> 52  D01000          5   5077158  45932073        4        2
#> 53  D01000          5  45932074  46099999        3        1
#> 54  D01000          5  46100000  50699999       NA       NA
#> 55  D01000          5  50700000 166219319        4        2
#> 56  D01000          5 166219320 169203521        4        2
#> 57  D01000          5 169203522 169430268        4        2
#> 58  D01000          5 169430269 180915259        4        2
#> 59  D01000          6     39681    206598        3        1
#> 60  D01000          6    206599  44973213        3        1
#> 61  D01000          6  44973214  58699999        4        2
#> 62  D01000          6  58700000  63299999       NA       NA
#> 63  D01000          6  63300000  99480023        2        0
#> 64  D01000          6  99480024 170899800        2        0
#> 65  D01000          7     40386  57999999        3        1
#> 66  D01000          7  58000000  61699999        3        1
#> 67  D01000          7  61700000 158821400        3        1
#> 68  D01000          8     10001    217894        1        0
#> 69  D01000          8    217895  43099999        1        0
#> 70  D01000          8  43100000  48099999       NA       NA
#> 71  D01000          8  48100000 123598234        3        1
#> 72  D01000          8 123598235 146364021        3        1
#> 73  D01000          9     47500  41957499        2        1
#> 74  D01000          9  41957500  47299999        2        1
#> 75  D01000          9  47300000  50699999        2        1
#> 76  D01000          9  50700000  70502499        2        1
#> 77  D01000          9  70502500 140273200        2        1
#> 78  D01000         10    130013   4708202        4        2
#> 79  D01000         10   4708203  37999999        4        2
#> 80  D01000         10  38000000  42299999       NA       NA
#> 81  D01000         10  42300000  57289980        4        2
#> 82  D01000         10  57289981 135389924        4        2
#> 83  D01000         11     20721    198985        2        1
#> 84  D01000         11    198986  20509984        3        1
#> 85  D01000         11  20509985  31730007        3        1
#> 86  D01000         11  31730008  36680019        3        1
#> 87  D01000         11  36680020  51599999        3        1
#> 88  D01000         11  51600000  55699999        3        1
#> 89  D01000         11  55700000  56940023        3        1
#> 90  D01000         11  56940024 134452200        3        1
#> 91  D01000         12     22500    169956        4        1
#> 92  D01000         12    169957  33299999        5        1
#> 93  D01000         12  33300000  38199999       NA       NA
#> 94  D01000         12  38200000 132349400        4        0
#> 95  D01000         12 132349401 133851894        4        0
#> 96  D01000         13         1  16299999        2        1
#> 97  D01000         13  16300000  19499999        2        1
#> 98  D01000         13  19500000 104762391        2        1
#> 99  D01000         13 104762392 104862880        2        1
#> 100 D01000         13 104862881 114142800        2        1
#> 101 D01000         13 114142801 115169877        1        0
#> 102 D01000         14         1  16099999        4        1
#> 103 D01000         14  16100000  19099999       NA       NA
#> 104 D01000         14  19100000  20459982        5        1
#> 105 D01000         14  20459983  78779982        4        1
#> 106 D01000         14  78779983  86943387        3        1
#> 107 D01000         14  86943388  90355402        4        1
#> 108 D01000         14  90355403 106393884        4        1
#> 109 D01000         15         1  15799999        1        0
#> 110 D01000         15  15800000  20699999       NA       NA
#> 111 D01000         15  20700000  22300843        3        0
#> 112 D01000         15  22300844  52100677        2        0
#> 113 D01000         15  52100678  83013601        3        1
#> 114 D01000         15  83013602 100338800        3        1
#> 115 D01000         15 100338801 102369182        3        1
#> 116 D01000         15 102369183 102399807        3        1
#> 117 D01000         16     90538    235417        8        4
#> 118 D01000         16    235418   1105425        9        4
#> 119 D01000         16   1105426   2249480        4        2
#> 120 D01000         16   2249481   2249498        4        2
#> 121 D01000         16   2249499   3567443       10        4
#> 122 D01000         16   3567444   3799606        6        3
#> 123 D01000         16   3799607   4120511        5        2
#> 124 D01000         16   4120512   4125240        9        3
#> 125 D01000         16   4125241   4391748        8        4
#> 126 D01000         16   4391749   4399073        5        2
#> 127 D01000         16   4399074   4488086        6        3
#> 128 D01000         16   4488087   4489859        6        1
#> 129 D01000         16   4489860   4493982        6        1
#> 130 D01000         16   4493983   4751463        6        1
#> 131 D01000         16   4751464   4823733        5        1
#> 132 D01000         16   4823734   4823863        4        1
#> 133 D01000         16   4823864   4839656        4        1
#> 134 D01000         16   4839657   7629124        5        2
#> 135 D01000         16   7629125   7765934        5        2
#> 136 D01000         16   7765935   8099989        4        2
#> 137 D01000         16   8099990   8249678        5        2
#> 138 D01000         16   8249679   8249742        6        3
#> 139 D01000         16   8249743   8355083        9        2
#> 140 D01000         16   8355084   8704625        2        0
#> 141 D01000         16   8704626   9334866        4        1
#> 142 D01000         16   9334867   9745190        5        2
#> 143 D01000         16   9745191   9794567        9        3
#> 144 D01000         16   9794568   9989436        5        1
#> 145 D01000         16   9989437  10146982        2        0
#> 146 D01000         16  10146983  13047149        2        0
#> 147 D01000         16  13047150  13310348        2        0
#> 148 D01000         16  13310349  13559822        3        0
#> 149 D01000         16  13559823  13667644        3        0
#> 150 D01000         16  13667645  13782795        2        0
#> 151 D01000         16  13782796  16318481        2        0
#> 152 D01000         16  16318482  16319844        2        0
#> 153 D01000         16  16319845  17351606        5        2
#> 154 D01000         16  17351607  17480155        4        1
#> 155 D01000         16  17480156  18179126        2        0
#> 156 D01000         16  18179127  18774104        5        1
#> 157 D01000         16  18774105  19393676        2        0
#> 158 D01000         16  19393677  19394220        2        0
#> 159 D01000         16  19394221  19410918        5        2
#> 160 D01000         16  19410919  19411314        5        2
#> 161 D01000         16  19411315  19902587        5        2
#> 162 D01000         16  19902588  19989997        8        3
#> 163 D01000         16  19989998  20213217        6        3
#> 164 D01000         16  20213218  22198630        2        0
#> 165 D01000         16  22198631  25359942        3        1
#> 166 D01000         16  25359943  25689934        5        2
#> 167 D01000         16  25689935  25851270        5        2
#> 168 D01000         16  25851271  26104847       10        4
#> 169 D01000         16  26104848  26106138        5        2
#> 170 D01000         16  26106139  26113873        5        2
#> 171 D01000         16  26113874  26304247        4        1
#> 172 D01000         16  26304248  26519982        5        2
#> 173 D01000         16  26519983  26640405        4        2
#> 174 D01000         16  26640406  26709826        3        1
#> 175 D01000         16  26709827  27809786        4        1
#> 176 D01000         16  27809787  27809799        3        1
#> 177 D01000         16  27809800  27811540        3        1
#> 178 D01000         16  27811541  27812217        3        1
#> 179 D01000         16  27812218  27824381        3        1
#> 180 D01000         16  27824382  29885284        5        2
#> 181 D01000         16  29885285  31054039        6        2
#> 182 D01000         16  31054040  34599999        3        1
#> 183 D01000         16  34600000  38599999       NA       NA
#> 184 D01000         16  38600000  46467499        2        1
#> 185 D01000         16  46467500  76689952        3        1
#> 186 D01000         16  76689953  76840012        5        2
#> 187 D01000         16  76840013  77299497        3        1
#> 188 D01000         16  77299498  78259406        3        1
#> 189 D01000         16  78259407  78317465        3        1
#> 190 D01000         16  78317466  78396366        3        1
#> 191 D01000         16  78396367  78432863        6        2
#> 192 D01000         16  78432864  78479995        3        1
#> 193 D01000         16  78479996  78619999        3        1
#> 194 D01000         16  78620000  78749460        3        1
#> 195 D01000         16  78749461  78840034        3        1
#> 196 D01000         16  78840035  78940011        5        2
#> 197 D01000         16  78940012  78959992        4        1
#> 198 D01000         16  78959993  79215084        3        1
#> 199 D01000         16  79215085  80548642        3        1
#> 200 D01000         16  80548643  80589948        3        1
#> 201 D01000         16  80589949  88827200        3        1
#> 202 D01000         16  88827201  90354752        1        0
#> 203 D01000         17         7  22199999        4        2
#> 204 D01000         17  22200000  25799999        4        2
#> 205 D01000         17  25800000  44797499        4        2
#> 206 D01000         17  44797500  78774600        4        2
#> 207 D01000         17  78774601  81195209        4        2
#> 208 D01000         18     43743  14087436        3        1
#> 209 D01000         18  14087437  15394602        3        1
#> 210 D01000         18  15394603  18999999       NA       NA
#> 211 D01000         18  19000000  39690003        5        2
#> 212 D01000         18  39690004  47528217        6        1
#> 213 D01000         18  47528218  76117000        5        2
#> 214 D01000         18  76117001  78077247        3        1
#> 215 D01000         19    255096  20470034        3        1
#> 216 D01000         19  20470035  24399999        3        1
#> 217 D01000         19  24400000  28599999        3        1
#> 218 D01000         19  28600000  29703088        3        1
#> 219 D01000         19  29703089  59128982        3        1
#> 220 D01000         20     26962  20062989        4        2
#> 221 D01000         20  20062990  25599999        3        1
#> 222 D01000         20  25600000  29452500       NA       NA
#> 223 D01000         20  29452501  47794972        3        1
#> 224 D01000         20  47794973  49713515        6        2
#> 225 D01000         20  49713516  49834358        5        2
#> 226 D01000         20  49834359  50194337        6        2
#> 227 D01000         20  50194338  50225896        9        3
#> 228 D01000         20  50225897  50945129        7        2
#> 229 D01000         20  50945130  51334000        7        2
#> 230 D01000         20  51334001  51514776       13        4
#> 231 D01000         20  51514777  52465051       10        3
#> 232 D01000         20  52465052  52583134        8        2
#> 233 D01000         20  52583135  52831553        8        2
#> 234 D01000         20  52831554  53540680       11        3
#> 235 D01000         20  53540681  53583632        8        2
#> 236 D01000         20  53583633  53698739        8        2
#> 237 D01000         20  53698740  53966170        8        2
#> 238 D01000         20  53966171  54011658        8        2
#> 239 D01000         20  54011659  54309995        8        2
#> 240 D01000         20  54309996  54641856        7        2
#> 241 D01000         20  54641857  55670027        8        2
#> 242 D01000         20  55670028  56661351        7        2
#> 243 D01000         20  56661352  57336659        6        2
#> 244 D01000         20  57336660  57351881        7        1
#> 245 D01000         20  57351882  57548463        6        2
#> 246 D01000         20  57548464  57552225        6        2
#> 247 D01000         20  57552226  57889140        5        2
#> 248 D01000         20  57889141  59350578        5        2
#> 249 D01000         20  59350579  59352200        6        3
#> 250 D01000         20  59352201  59391634        2        0
#> 251 D01000         20  59391635  59796217        2        0
#> 252 D01000         20  59796218  60443299        5        2
#> 253 D01000         20  60443300  62385800        4        2
#> 254 D01000         21         1  10899999       NA       NA
#> 255 D01000         21  10900000  15292905        3        1
#> 256 D01000         21  15292906  32446001        3        1
#> 257 D01000         21  32446002  46937500        3        1
#> 258 D01000         21  46937501  48129894        1        0
#> 259 D01000         22         1  12199999        1        0
#> 260 D01000         22  12200000  17899999       NA       NA
#> 261 D01000         22  17900000  29065729        2        0
#> 262 D01000         22  29065730  29065815        2        0
#> 263 D01000         22  29065816  32147536        2        0
#> 264 D01000         22  32147537  32160607        0        0
#> 265 D01000         22  32160608  49687500        2        0
#> 266 D01000         22  49687501  51304565        1        0
```
